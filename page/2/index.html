<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>扶摇之鹏</title><meta name="keywords" content="Smartog 分布式存储 个人博客"><meta name="author" content="Smartog,2369398685@qq.com"><meta name="copyright" content="Smartog"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="欢迎交流">
<meta property="og:type" content="website">
<meta property="og:title" content="扶摇之鹏">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="扶摇之鹏">
<meta property="og:description" content="欢迎交流">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/8f7b645dd13642308f79801772084d7c.jpeg">
<meta property="article:author" content="Smartog">
<meta property="article:tag" content="Smartog 分布式存储 个人博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/8f7b645dd13642308f79801772084d7c.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/page/2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.min.js',
      css: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '扶摇之鹏',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-08-13 10:25:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://img-blog.csdnimg.cn/8f7b645dd13642308f79801772084d7c.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">扶摇之鹏</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/24/cmu445-Concurrency-Control/" title="cmu445_Concurrency_Control">cmu445_Concurrency_Control</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-24T01:48:04.000Z" title="发表于 2022-07-24 09:48:04">2022-07-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-24T03:05:53.799Z" title="更新于 2022-07-24 11:05:53">2022-07-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu15-445/">cmu15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">背景引入在前面的课程中介绍了 DBMS 的主要模块及架构，自底向上依次是 Disk Manager、Buffer Pool Manager、Access Methods、Operator Execution 及 Query Planning。

但数据库要解决的问题并不仅仅停留在功能的实现上，它还需要具备：（1）满足多个用户同时读写数据，即 Concurrency Control，如：两个用户同时写入同一条记录。（2）面对故障，如宕机，能恢复到之前的状态，即 Recovery，如：你在银行系统转账时，转到一半忽然停电。Concurrency Control 与 Recovery 都是 DBMS的重要特性，它们渗透在 DBMS 的每个主要模块中。而二者的基础都是具备 ACID 特性的 Transactions，因此本节的讨论从 Transactions 开始。
Transactions用一句白话说，transaction 是 DBMS 状态变化的基本单位，一个 transaction 只能有执行和未执行两个状态，不存在部分执行的状态。一个典型的 transaction 实例就是：从 A  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/22/cmu445-Query-Planning-Optimization/" title="cmu445_Query_Planning_Optimization">cmu445_Query_Planning_Optimization</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-22T03:28:21.000Z" title="发表于 2022-07-22 11:28:21">2022-07-22</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-24T00:20:33.443Z" title="更新于 2022-07-24 08:20:33">2022-07-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">背景SQL 语句让我们能够描述想要获取的数据，而 DBMS 负责来根据用户的需求来制定高效的查询计划。不同的查询计划的效率可能出现多个数量级的差别，如 Join Algorithms 一节中的 Simple Nested Loop Join 与 Hash Join 的时间对比 (1.3 hours vs. 0.45 seconds)。
Query Optimizer 第一次出现在 IBM System R，那时人们认为 DBMS 指定的查询计划永远无法比人类指定的更好。System R 的 optimizer 中的一些理念至今仍在使用。
查询优化技术Heuristics/Rules

Rewrite the query to remove stupid/inefficient things
Does not require a cost model

Cost-based Search

Use a cost model to evalucate multiple equivalent plans and pick the one with the lowest cost


上图为查 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/22/cmu445-Query-Execution/" title="cmu445_Query_Execution">cmu445_Query_Execution</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-22T03:27:50.000Z" title="发表于 2022-07-22 11:27:50">2022-07-22</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-23T09:23:13.488Z" title="更新于 2022-07-23 17:23:13">2022-07-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">Query Plan如图所示，通常一个 SQL 会被组织成树状的查询计划，数据从 leaf nodes 流到 root，查询结果在 root 中得出。而本节将讨论在这样一个计划中，如何为这个数据流动过程建模，主要围绕：

Processing Models

Access Methods

Expression Evaluation



Processing ModelsDBMS 的 processing model 定义了系统如何执行一个 query plan，目前主要有三种模型，不同模型的适用场景不同。




Model
Direction
Emits
Target




Iterator/Volcano
Top-Down
Single Tuple
General Purpose


Materialization
Bottom-Up
Entire Tuple Set
OLTP


Vectorized
Top-Down
Tuple Batch
OLAP




Iterator Modelquery plan 中的每步 operator 都实现一个 next 函数，每次调用 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/22/cmu445-Join-Algorithm/" title="cmu445_Join_Algorithm">cmu445_Join_Algorithm</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-22T03:26:29.000Z" title="发表于 2022-07-22 11:26:29">2022-07-22</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-23T08:07:55.849Z" title="更新于 2022-07-23 16:07:55">2022-07-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">本节主体部分介绍以下三种Join算法：

Nested Loop Join（Simple、Block、Index）

Sort-Merge Join

Hash Join


为什么进行Join操作为了避免保存重复信息，我们一般会通过范式将表数据保存在数据库中。我们利用Join操作来还原重建原始的表数据。以课程伊始时的 table 为例，通过将 Artist 与 Album 之间的多对多关系拆成 Artist, ArtistAlbum 以及 Album 三个 tables 来规范化数据，使得数据存储的冗余减少，查询时我们就需要通过 Join 来重建 Artist 与 Album 的完整关系数据。

本课时主要讨论了Join操作的output以及I/O分析两个方面的内容。
Join 输出逻辑上 Join 的操作的结果是：对任意一个 tuple r ∈  R  和任意一个在 Join Attributes 上对应的 tuple s ∈ S，将 r 和 s 串联成S一个新的 tuple。

Join 操作的结果 tuple 中除了 Join Attributes 之外的信息与多个因素相关：（ ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/21/cmu15-445-Sorting/" title="cmu15-445_Sorting&amp;Aggregation">cmu15-445_Sorting&amp;Aggregation</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-21T04:18:45.000Z" title="发表于 2022-07-21 12:18:45">2022-07-21</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-21T14:36:51.485Z" title="更新于 2022-07-21 22:36:51">2022-07-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">Sorting我们需要排序，因为在关系模型中，表中的元组没有特定的顺序。排序（可能）按顺序BY、组BY、JOIN和不同的操作符使用。不仅仅是 order by 需要排序，像 DISTINCT 、GROUP BY 指令也需要有排序T这个需求。DISTINCT 指令的主要工作是先排序，然后去重。GROUP BY 是分组聚合指令，需要把相同的类型聚集在一起，更需要用到排序操作。
我们可以通过从左到右扫描叶节点，使用clustered B+树来加速排序。然而，如果我们使用一个unclustered B+树来排序，这是一个坏主意，因为它会导致大量的I/O读取（通过指针跟踪的随机访问）。
如果我们需要排序的数据可以装入内存，那么DBMS可以使用标准的排序算法（例如，快速排序）。如果数据不能全部装入内存，那么DBMS需要使用外部排序，它能够根据需要溢出到磁盘，并且更倾向于使用顺序排序，而不是随机I/O。
External Merge Sort分治排序算法，将数据集划分为不同的运行，然后分别对它们进行排序。它可以根据需要将运行溢出到磁盘，然后一次读取它们。

下图是一个2路外部归并排序的例子，首先利用 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/21/cmu15-445-IndexConcurrency/" title="cmu15-445_IndexConcurrency">cmu15-445_IndexConcurrency</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-21T04:17:49.000Z" title="发表于 2022-07-21 12:17:49">2022-07-21</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-21T10:45:22.551Z" title="更新于 2022-07-21 18:45:22">2022-07-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">索引并发控制本节讨论让数据结构具备并发安全的特点，尽管本节仅仅是介绍 B+ Tree 上的相关技术。在前两节中讨论的数据结构中，我们都只考虑单线程访问的情况，即只能有一个线程在同时刻访问我们的数据结构。现实中我们是希望多线程在同一时刻访问我们的数据结构。本节课讨论允许多个线程安全地访问我们的数据结构，现在的CPU都是多核，需要考虑到允许多个线程查询和更新。
通常我们会从两个层面上来理解并发控制的正确性：

逻辑正确性：（后续讨论）我希望看到的值是我期待看到的值！例如我插入了5这个值，等我插入完后回过头看，5这个值应该存在，而不会是false的。
物理正确性：（本节讨论）数据的内部表示是否完好？如何保证线程读取数据时该数据结构的可靠性？

Locks vs Latches本课程主要研究的是Latches

数据库中特有的 Locks 一般是指行锁、范围锁、表锁这些。用来做事务之间的并发控制。是更为上层的抽象锁。在整个事务期间持有，DBMS需要具有回滚功能。

Latches 就是在多线程编程、操作系统学习中遇到的多线程中接触到的锁，如 mutex、rwlock、semaphore、spi ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/19/cmu445-Tree-Indexes/" title="cmu445-6 Tree Indexes">cmu445-6 Tree Indexes</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-19T07:41:38.000Z" title="发表于 2022-07-19 15:41:38">2022-07-19</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-20T14:48:53.455Z" title="更新于 2022-07-20 22:48:53">2022-07-20</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">Indexestable index是数据columns子集的复制，允许DBMS可以比顺序扫描更快的查找tuple。DBMS保证数据表的内容和索引内容同步。对于指定查询，选择哪一种索引以使得查询执行的更快是DBMS来完成的。建立索引需要额外的存储开销，也需要维护，所以每个数据库创建的索引数量需要trade-off。
B+Tree定义：

自平衡，每个叶子节点所处高度一致

除叶子节点外每个节点至少满足:\frac{M}{2} − 1 </div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/18/cmu445-hash_table/" title="cmu445-5 Hash Table">cmu445-5 Hash Table</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-17T23:16:46.000Z" title="发表于 2022-07-18 07:16:46">2022-07-18</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-19T01:51:57.044Z" title="更新于 2022-07-19 09:51:57">2022-07-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">讨论如何支持DBMS执行引擎从页中读写数据。主要涉及两种数据结构：

Hash Tables
Trees

Data StructureDBMS为系统内部的许多不同部分使用不同的数据结构：

Internal Meta-Data：
跟踪有关数据库和系统状态的信息

Core Data Storage：
可用作数据库中的元组的基本存储器

Temporary Data Structure：
DBMS可以在处理查询时动态地构建数据结构，以加快执行速度（例如，连接的哈希表）

Table Indexes：
辅助数据结构，使它更容易找到特定的元组


设计决策：

数据组织：我们如何布局内存，以及在数据结构中存储的信息。
并发性：如何使多个线程能够访问数据结构而不会引起问题。

Hash Table 哈希表实现了一个将键映射到值的关联数组抽象数据类型。它提供了平均O(1)操作复杂性和O(n)存储复杂度。
哈希表的实现可以分为两个部分：

Hash Function：
如何将一个很大的地址空间映射到一个更小的域，将索引通过计算映射到一个桶数组或者slot。需要在计算速度与哈希碰撞率之间进行权衡。 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/16/cmu445-4/" title="cmu445-4 Buffer Pools">cmu445-4 Buffer Pools</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-16T08:28:29.000Z" title="发表于 2022-07-16 16:28:29">2022-07-16</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-17T10:00:45.954Z" title="更新于 2022-07-17 18:00:45">2022-07-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">上一节描述了DBMS如何在磁盘的文件上描述数据库，这一节将描述DBMS如何管理其内存以及管理数据在磁盘上的来回移动。
这里总结一下两个概念：
Spatial Control：空间控制

将页面写入磁盘的哪个位置
其目标是使一起使用的页面在物理上尽可能接近

Temporal Control：时间控制

何时将页面读入内存，何时将其写入磁盘
其目标是最小化必须从磁盘读取数据时产生的延迟

Locks vs. Latches在讨论DBMS如何保护其内部元素时，我们需要区分锁（lock）和锁存器（latch）。
Lock：

保护数据库的逻辑内容，如元组、表、数据库不受其他事务影响
事务处理期间一直持有
需要能够回滚更改

Latch：

保护DBMS内部数据结构的关键部分不受其他线程的影响
操作期间持有
不需要能够回滚更改

Buffer PoolBuffer Pool是从磁盘读取的页面的内存缓存。由于DBMS比OS更了解数据库的实际状况，所以我们想要自己管理内存以及页面。
Buffer Pool是一个由固定大小页面数组组织起来的内存区域。数组中的每一项称为frame。当DBMS请求一个页 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/14/cmu445-3/" title="cmu15-445-3 Data Storage">cmu15-445-3 Data Storage</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-14T12:10:35.000Z" title="发表于 2022-07-14 20:10:35">2022-07-14</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-15T13:55:31.681Z" title="更新于 2022-07-15 21:55:31">2022-07-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu-15-445/">cmu 15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">存储我们将重点关注一个“面向磁盘”的DBMS体系结构，该体系结构假设数据库的主存储位置位于非易失性磁盘上。
在存储层次结构的顶部，您有最接近CPU的设备。这是最快的存储空间，但它也是最小和最昂贵的。远离CPU越远，存储设备的容量就越大，但离CPU也越远。这些设备的每GB值也会更便宜。

Volatile Devices:

Volatile means that if you pull the power from the machine, then the data is lost.
Volatile storage supports fast random access with byte-addressable locations. This means that the program can jump to any byte address and get the data that is there.
For our purposes, we will always refer to this storage class as “memory”.

Non-Volatile ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/#content-inner">5</a><a class="extend next" rel="next" href="/page/3/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://img-blog.csdnimg.cn/8f7b645dd13642308f79801772084d7c.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Smartog</div><div class="author-info__description">欢迎交流</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Smartog"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Smartog" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2369398685@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/08/11/nKV/" title="nKV Near-Data Processing with KV-Stores on Native Computational Storage">nKV Near-Data Processing with KV-Stores on Native Computational Storage</a><time datetime="2022-08-11T02:13:50.000Z" title="发表于 2022-08-11 10:13:50">2022-08-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/08/10/PIM-and-CSD/" title="PIM_and_CSD">PIM_and_CSD</a><time datetime="2022-08-10T10:08:37.000Z" title="发表于 2022-08-10 18:08:37">2022-08-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/07/24/cmu445-Distributed-OLAP-Databases/" title="cmu445_Distributed_OLAP_Databases">cmu445_Distributed_OLAP_Databases</a><time datetime="2022-07-24T01:50:18.000Z" title="发表于 2022-07-24 09:50:18">2022-07-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/07/24/cmu445-Distributed-OLTP-Databases/" title="cmu445_Distributed_OLTP_Databases">cmu445_Distributed_OLTP_Databases</a><time datetime="2022-07-24T01:50:11.000Z" title="发表于 2022-07-24 09:50:11">2022-07-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/07/24/cmu445-Distributed-Databases/" title="cmu445_Distributed_Databases">cmu445_Distributed_Databases</a><time datetime="2022-07-24T01:50:02.000Z" title="发表于 2022-07-24 09:50:02">2022-07-24</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DDIA/"><span class="card-category-list-name">DDIA</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/book-reading/"><span class="card-category-list-name">book reading</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cmu-15-445/"><span class="card-category-list-name">cmu 15-445</span><span class="card-category-list-count">11</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cmu15-445/"><span class="card-category-list-name">cmu15-445</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/defualt/"><span class="card-category-list-name">defualt</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/paper/"><span class="card-category-list-name">paper</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%97%A5%E8%AE%B0/"><span class="card-category-list-name">日记</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%A6%82%E5%BF%B5/"><span class="card-category-list-name">概念</span><span class="card-category-list-count">8</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/distributed-system/" style="font-size: 1.15em; color: rgb(61, 196, 183)">distributed system</a><a href="/tags/MapReduce/" style="font-size: 1.15em; color: rgb(71, 174, 91)">MapReduce</a><a href="/tags/%E6%97%A5%E8%AE%B0/" style="font-size: 1.15em; color: rgb(200, 99, 199)">日记</a><a href="/tags/DDIA/" style="font-size: 1.3em; color: rgb(111, 78, 198)">DDIA</a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE/" style="font-size: 1.15em; color: rgb(150, 99, 81)">分布式数据</a><a href="/tags/os/" style="font-size: 1.15em; color: rgb(9, 42, 88)">os</a><a href="/tags/operating-system/" style="font-size: 1.15em; color: rgb(131, 28, 73)">operating system</a><a href="/tags/memory/" style="font-size: 1.15em; color: rgb(21, 53, 45)">memory</a><a href="/tags/%E3%80%8A%E5%A4%A7%E8%AF%9D%E5%AD%98%E5%82%A8%E7%BB%88%E6%9E%81%E7%89%88%E3%80%8B/" style="font-size: 1.38em; color: rgb(53, 200, 51)">《大话存储终极版》</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E3%80%81%E5%AD%98%E5%82%A8/" style="font-size: 1.15em; color: rgb(61, 3, 146)">数据库、存储</a><a href="/tags/RAID/" style="font-size: 1.15em; color: rgb(178, 100, 76)">RAID</a><a href="/tags/%E5%AD%98%E5%82%A8/" style="font-size: 1.22em; color: rgb(112, 6, 160)">存储</a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 1.15em; color: rgb(174, 53, 13)">密码学</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.15em; color: rgb(32, 138, 16)">数据库</a><a href="/tags/database-system/" style="font-size: 1.45em; color: rgb(0, 68, 65)">database system</a><a href="/tags/CSD/" style="font-size: 1.15em; color: rgb(17, 80, 164)">CSD</a><a href="/tags/Key-Value-store/" style="font-size: 1.15em; color: rgb(157, 200, 53)">Key Value store</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/07/"><span class="card-archive-list-date">七月 2022</span><span class="card-archive-list-count">35</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">五月 2022</span><span class="card-archive-list-count">6</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">43</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-08-13T02:25:36.569Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Smartog</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/pluginsSrc/medium-zoom/dist/medium-zoom.min.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="/pluginsSrc/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="/pluginsSrc/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>
<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>扶摇之鹏</title><meta name="keywords" content="Smartog 分布式存储 个人博客"><meta name="author" content="Smartog,2369398685@qq.com"><meta name="copyright" content="Smartog"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="欢迎交流">
<meta property="og:type" content="website">
<meta property="og:title" content="扶摇之鹏">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="扶摇之鹏">
<meta property="og:description" content="欢迎交流">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/8f7b645dd13642308f79801772084d7c.jpeg">
<meta property="article:author" content="Smartog">
<meta property="article:tag" content="Smartog 分布式存储 个人博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/8f7b645dd13642308f79801772084d7c.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/page/2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.min.js',
      css: '/pluginsSrc/flickr-justified-gallery/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '扶摇之鹏',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-10-22 18:19:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://img-blog.csdnimg.cn/8f7b645dd13642308f79801772084d7c.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">55</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">扶摇之鹏</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/15/storage-dictory/" title="storage_dictory">storage_dictory</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-15T08:08:35.000Z" title="发表于 2022-08-15 16:08:35">2022-08-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-15T11:54:46.688Z" title="更新于 2022-08-15 19:54:46">2022-08-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%A6%82%E5%BF%B5/">概念</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%AD%98%E5%82%A8/">存储</a></span></div><div class="content">在论文阅读时经常会遇到一些专有名词，之前在一本计算机网络书中看到里边有一个专有名词字典，感觉对学习很有帮助，最近在看存储方面的论文，想着应该整理一下遇到的一些专有名词背后的含义，希望对以后的学习能起到促进作用。
 HDD
 SSD
 RAM
 SRAM
 DRAM
 ROM
</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/15/IRAM/" title="A case for Intelligent RAM/DISK">A case for Intelligent RAM/DISK</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-15T08:00:11.000Z" title="发表于 2022-08-15 16:00:11">2022-08-15</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-17T15:10:13.005Z" title="更新于 2022-08-17 23:10:13">2022-08-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/paper/">paper</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/RAM%E3%80%81%E5%AD%98%E5%82%A8/">RAM、存储</a></span></div><div class="content">IRAM/IDISK是UC伯克利大学计算机学院的一个科研项目。文中数据来源与写作时行业发展状况。
 IRAM
 Intro
Intelligent RAM，IRAM将处理器和内存融合到一块chip上以降低内存延迟、增加内存带宽以及提高能耗利用率。IRAM提供灵活的内存大小、组织选择，可以节约板上面积。文本回顾了微处理器以及DRAM在当时的发展状况，探讨了IRAM面对的机遇以及挑战，最后预估了三种IRAM设计的性能和能耗。
 Why there is a problem
半导体行业划分成微处理器和存储两个阵营带来了诸多好处。
首先，生产商可以为特定设备定制生产线微处理器生产线提供了快速晶体管、快速逻辑和许多金属层，以加速通信和简化电力分配。另一方面，DRAM晶圆厂提供了许多多晶硅层，以实现较小的DRAM电池和低漏电流，以降低DRAM的刷新率。其次，单独的芯片也意味着单独的包装，计算机设计者可以不依赖于处理器的数量，扩展存储芯片的数量。
但是两大阵营的划分也有缺点，主要就是处理器和内存之间的性能差距越来越大。系统架构层面人们尝试引入越来越深的cache、memory架构来减小这一差距，但是 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/11/nKV/" title="nKV Near-Data Processing with KV-Stores on Native Computational Storage">nKV Near-Data Processing with KV-Stores on Native Computational Storage</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-11T02:13:50.000Z" title="发表于 2022-08-11 10:13:50">2022-08-11</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-13T02:24:06.615Z" title="更新于 2022-08-13 10:24:06">2022-08-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/paper/">paper</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Key-Value-store/">Key Value store</a></span></div><div class="content">ABSTRACT现代KV存储中大量的数据迁移来源于低效的data-locality(the process of moving computation to the node where that data resides, instead of vice versa)，此外data-to-code系统设计(Data as Code is an approach that gives data teams the ability to process, manage, consume, and share data in the same way we do for code during software development. Data as Code empowers end users to take control of their data to accelerate iterations and increase collaboration)也降低了数据迁移的性能以及可扩展性。NDP的出现可能提供新的解决方法。
这篇论文提出了nKV，其利用了native computa ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/08/10/PIM-and-CSD/" title="PIM_and_CSD">PIM_and_CSD</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-10T10:08:37.000Z" title="发表于 2022-08-10 18:08:37">2022-08-10</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-10T10:24:19.555Z" title="更新于 2022-08-10 18:24:19">2022-08-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%A6%82%E5%BF%B5/">概念</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/CSD/">CSD</a></span></div><div class="content">如今的商用和消费类电子设备都是朝向智能、轻量、便携化的设计路线，但是随之密集的大数据流和算法处理的挑战相对于冯氏架构瓶颈就成为了矛盾；以及器件尺寸微缩带来的功耗与可靠性要求也加剧了这种矛盾。因此近年来才演进出了存算一体需求，进而演变到PIM、未来内存构型以及新计算体系结构的问题，应用场景覆盖不论IDC还是端边侧AIoT。
在经典冯结构中，数据需要在存储、内存、缓存、多个核的计算单元之间不断搬运，且器件彼此的距离相加，导致大量的时间、带宽、缓存空间、功耗都消耗在了搬运上，而非计算上，因此才有了内存墙的问题。为了突破冯结构瓶颈，降低数据搬运的开销，传统技法包括增加数据总线带宽和时钟频率，但随之带来了更大的功耗与硬件成本开销，且扩展性也更加受限。
存算一体的设计宗旨，就是旨在把传统以计算为中心的架构转变成以数据为中心的架构，把以主处理器为单一计算核心的架构转变成由近至远的包括存储/网卡在内的分布式多计算核心的架构；直接利用存储器承担大部分数据处理/计算任务，两种设备融合在同一芯片当中就大幅规避了冯结构影响，尤适用于DL神经网络计算这种大数据流、大规模并行的场景。此外，与亚阈值的digital ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/24/cmu445-Distributed-OLAP-Databases/" title="cmu445_Distributed_OLAP_Databases">cmu445_Distributed_OLAP_Databases</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-24T01:50:18.000Z" title="发表于 2022-07-24 09:50:18">2022-07-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-13T02:33:50.751Z" title="更新于 2022-08-13 10:33:50">2022-08-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu15-445/">cmu15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">IntroOLTP and OLAP众所周知，数据库有两种典型使用场景，OLTP 和 OLAP。线上服务与 OLTP 数据库交互，OLTP 数据库再被异步地导出到 OLAP 数据库中作离线分析，如下图所示：

OLTP 数据库就是 OLAP 数据库的前端，通过 ETL 的过程，OLTP 数据库中的数据将被清理、重新整理到 OLAP 数据库上。OLAP 数据库为用户提供复杂的数据查询、分析能力，帮助公司：分析过去和预测未来。
Star Schema vs. Snowflake SchemaETL 的过程并不只是简单地移动，通常还会涉及表结构的重新整理，以提高后续查询分析的效率。最常见的两种 schema 就是 Star Schema 和 Snowflak Schema：

Star Schema 就是一个星形拓扑结构，处在最中间的是 Fact Table，通常记录着业务流程中的核心事件、指标，如成单记录；处在四周的是 Dimension Tables，记录一些补充信息。Fact Table 通过外键与 Dimension Tables 关联，用户可以通过简单的 Join 来分析数据。在  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/24/cmu445-Distributed-OLTP-Databases/" title="cmu445_Distributed_OLTP_Databases">cmu445_Distributed_OLTP_Databases</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-24T01:50:11.000Z" title="发表于 2022-07-24 09:50:11">2022-07-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-13T02:33:56.366Z" title="更新于 2022-08-13 10:33:56">2022-08-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu15-445/">cmu15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">上节课我们介绍了分布式事务的去中心化实现：

应用程序要发起一次事务时，先通过某种方式选择这个事务的 master node，并向它发送事务开始的请求。

master node 同意后，应用程序向事务涉及的节点发送数据更新请求，此时每个节点都只是执行请求但尚未提交。

master node 收到所有节点的响应后，向 master node 发送事务提交的请求，master node 再问其它节点是否可以安全提交。若是，则确保所有节点提交事务后由 master node 返回成功，若否，则确保所有节点回滚成功，同时由 master node 返回失败。
但上节课我们没有讨论如何确保所有节点都认同事务提交，所有节点在同意之后实际执行了提交。这里有很多细节需要考虑：

如果一个节点发生了故障怎么办？
如果这期间节点之间消息传递延迟了怎么办？
我们是否需要等待所有都节点都同意？如果集群较大等待时间就会由于短板效应而增加。

本节我们就来讨论一下这些问题。
Assumption我们首先需要假设在分布式数据库中，所有节点都是好孩子，都受到严格的控制，不会耍坏心眼，让它提交就提交，让它回滚就回滚 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/24/cmu445-Distributed-Databases/" title="cmu445_Distributed_Databases">cmu445_Distributed_Databases</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-24T01:50:02.000Z" title="发表于 2022-07-24 09:50:02">2022-07-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-13T02:34:04.167Z" title="更新于 2022-08-13 10:34:04">2022-08-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu15-445/">cmu15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">当我们在谈论分布式数据库时，首先要明确什么是分布式系统：如果通信成本和通信的可靠性问题不可忽略，就是分布式系统。这也是区分 Parallel DBMS 和 Distributed DBMS 的依据所在
Parallel DBMSs
Distributed DBMSs
不同节点在物理上隔得很近
不同节点在物理上可能隔得很远
不同节点通过高速局域网连接
不同节点通过普通公共网络相连接
通信成本很小，基本不会产生问题
通信成本和通信问题不可忽略
那么如何利用我们在这节课中介绍的单节点 DBMS 的知识，构建支持事务的 Distributed DBMS 呢？之前讨论过的很多话题：

Optimization &amp; Planning
Concurrency Control
Logging &amp; Recovery

在分布式环境下都可能遇到新的挑战。
System ArchitectureDistributed DBMS 的系统架构主要指的是在哪一层上共享资源，主要分为以下 4 种：

实际上 Shared Everything 就没有分布式可言了，因此严格来说，只有 Shared M ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/24/cmu445-Database-Recovery/" title="cmu445_Database_Recovery">cmu445_Database_Recovery</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-24T01:49:48.000Z" title="发表于 2022-07-24 09:49:48">2022-07-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-25T08:52:11.171Z" title="更新于 2022-07-25 16:52:11">2022-07-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu15-445/">cmu15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">上节课介绍到，故障恢复算法由两个部分构成：

在事务执行过程中采取的行动来确保出现故障时能够恢复 (上节课)
在故障发生后的恢复机制，确保原子性、一致性和持久性 (本节课)

ARIES本节课介绍的是 Algorithms for Recovery and Isolation Exploiting Semantics (ARIES)，由 IBM Research 在 90 年代初为 DB2 DBMS 研发的基于 WAL 的故障恢复机制，尽管并非所有 DBMS 都严格按照 ARIES paper 实现故障恢复机制，但它们的思路基本一致。
ARIES 的核心思想可以总结为 3 点：

Write-Ahead Logging (WAL)

在数据落盘之前，所有写操作都必须记录在日志中并落盘

必须使用 Steal + No-Force 缓存管理策略 (buffer pool policies)



Repeating History During Redo

当 DBMS 重启时，按照日志记录的内容重做数据，恢复到故障发生前的状态


Changes During Undo

在 undo ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/24/cmu445-Logging-Schemes/" title="cmu445_Logging_Schemes">cmu445_Logging_Schemes</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-24T01:49:35.000Z" title="发表于 2022-07-24 09:49:35">2022-07-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-25T06:51:16.247Z" title="更新于 2022-07-25 14:51:16">2022-07-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu15-445/">cmu15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">数据库在运行时可能遭遇各种故障，这时可能同时有许多正在运行的事务，如果这些事务执行到一半时故障发生了，就可能导致数据库中的数据出现不一致的现象：

这时就需要故障恢复机制来保证数据库的原子性、一致性、持久性。故障恢复机制包含两部分：

在事务执行过程中采取的行动来确保在出现故障时能够恢复 (本节课)

在故障发生后的恢复机制，确保原子性、一致性和持久性 (下节课)


本节主要内容包括：

Failure Classification

Buffer Pool Policies

Shadow Paging

Write-Ahead Log

Logging Schemes

Checkpoints


Failure Classification世上并不存在能够容忍任何故障的容错机制，即便做了异地多活，一次小行星撞地球也能将你的系统一举歼灭，因此在讨论故障恢复之前，我们必须先为故障分类，明确需要容忍的故障类型。
一般故障类型可以分为 3 种：

事务故障 (Transaction Failures)

逻辑错误 (Logical Errors)：由于一些内部约束，如数据一致性约束，导 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/07/24/cmu445-Multiversion-Concurrency-Control/" title="cmu445_Multiversion_Concurrency_Control">cmu445_Multiversion_Concurrency_Control</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-24T01:49:19.000Z" title="发表于 2022-07-24 09:49:19">2022-07-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-24T13:41:01.488Z" title="更新于 2022-07-24 21:41:01">2022-07-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cmu15-445/">cmu15-445</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/database-system/">database system</a></span></div><div class="content">简介简而言之，实现 MVCC 的 DBMS 在内部维持着单个逻辑数据的多个物理版本，当事务修改某数据时，DBMS 将为其创建一个新的版本；当事务读取某数据时，它将读到该数据在事务开始时刻之前的最新版本。
MVCC 首次被提出是在 1978 年的一篇  MIT 的博士论文中。在 80 年代早期，DEC 的 Rdb/VMS 和 InterBase 首次真正实现了 MVCC，其作者是 Jim Starkey，NuoDB 的联合创始人。如今，Rdb/VMS 成了 Oracle Rdb，InterBase 成为开源项目 Firebird。
MVCCMVCC 的核心优势可以总结为以下两句话：

Writers don’t block readers. 写不阻塞读

Readers don’t block writers. 读不阻塞写


只读事务无需加锁就可以读取数据库某一时刻的快照，如果保留数据的所有历史版本，DBMS 甚至能够支持读取任意历史版本的数据，即 time-travel。
Example #1事务T_1和T_2分别获得时间戳 1 和 2，二者的执行过程如下图所示。开始前，数据库存有数 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/#content-inner">6</a><a class="extend next" rel="next" href="/page/3/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://img-blog.csdnimg.cn/8f7b645dd13642308f79801772084d7c.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Smartog</div><div class="author-info__description">欢迎交流</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">55</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Smartog"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Smartog" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2369398685@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/10/22/PCIe/" title="PCIe协议学习记录">PCIe协议学习记录</a><time datetime="2022-10-22T10:15:44.000Z" title="发表于 2022-10-22 18:15:44">2022-10-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/10/22/TridentKV/" title="TridentKV A Read-Optimized LSM-Tree Based KV Store via Adaptive Indexing and Space-Effificient Partitioning">TridentKV A Read-Optimized LSM-Tree Based KV Store via Adaptive Indexing and Space-Effificient Partitioning</a><time datetime="2022-10-22T10:15:44.000Z" title="发表于 2022-10-22 18:15:44">2022-10-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/10/14/ACkey/" title="AC-Key——Adaptive Caching for LSM-based Key-Value Stores">AC-Key——Adaptive Caching for LSM-based Key-Value Stores</a><time datetime="2022-10-14T04:40:04.000Z" title="发表于 2022-10-14 12:40:04">2022-10-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/10/14/Bourbon/" title="From WiscKey to Bourbon A Learned Index for Log-Structured Merge Trees">From WiscKey to Bourbon A Learned Index for Log-Structured Merge Trees</a><time datetime="2022-10-14T04:40:04.000Z" title="发表于 2022-10-14 12:40:04">2022-10-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/09/25/the-era-of-co-designed-storage-devices/" title="Not your Grandpa's SSD:The Era of Co-Designed Storage Devices">Not your Grandpa's SSD:The Era of Co-Designed Storage Devices</a><time datetime="2022-09-25T02:42:17.000Z" title="发表于 2022-09-25 10:42:17">2022-09-25</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DDIA/"><span class="card-category-list-name">DDIA</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/book-reading/"><span class="card-category-list-name">book reading</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cmu15-445/"><span class="card-category-list-name">cmu15-445</span><span class="card-category-list-count">20</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/defualt/"><span class="card-category-list-name">defualt</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/paper/"><span class="card-category-list-name">paper</span><span class="card-category-list-count">12</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%97%A5%E8%AE%B0/"><span class="card-category-list-name">日记</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%A6%82%E5%BF%B5/"><span class="card-category-list-name">概念</span><span class="card-category-list-count">10</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/distributed-system/" style="font-size: 1.15em; color: rgb(118, 42, 72)">distributed system</a><a href="/tags/MapReduce/" style="font-size: 1.15em; color: rgb(5, 180, 190)">MapReduce</a><a href="/tags/%E6%97%A5%E8%AE%B0/" style="font-size: 1.15em; color: rgb(27, 39, 137)">日记</a><a href="/tags/DDIA/" style="font-size: 1.27em; color: rgb(125, 75, 162)">DDIA</a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE/" style="font-size: 1.15em; color: rgb(149, 81, 22)">分布式数据</a><a href="/tags/os/" style="font-size: 1.15em; color: rgb(190, 73, 183)">os</a><a href="/tags/operating-system/" style="font-size: 1.15em; color: rgb(22, 80, 79)">operating system</a><a href="/tags/memory/" style="font-size: 1.15em; color: rgb(73, 83, 166)">memory</a><a href="/tags/%E3%80%8A%E5%A4%A7%E8%AF%9D%E5%AD%98%E5%82%A8%E7%BB%88%E6%9E%81%E7%89%88%E3%80%8B/" style="font-size: 1.39em; color: rgb(110, 131, 95)">《大话存储终极版》</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E3%80%81%E5%AD%98%E5%82%A8/" style="font-size: 1.15em; color: rgb(79, 146, 115)">数据库、存储</a><a href="/tags/RAID/" style="font-size: 1.15em; color: rgb(72, 88, 145)">RAID</a><a href="/tags/%E5%AD%98%E5%82%A8/" style="font-size: 1.27em; color: rgb(57, 146, 195)">存储</a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 1.15em; color: rgb(109, 58, 48)">密码学</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.15em; color: rgb(183, 170, 111)">数据库</a><a href="/tags/database-system/" style="font-size: 1.45em; color: rgb(103, 75, 104)">database system</a><a href="/tags/CSD/" style="font-size: 1.21em; color: rgb(40, 10, 32)">CSD</a><a href="/tags/Key-Value-store/" style="font-size: 1.33em; color: rgb(43, 167, 146)">Key Value store</a><a href="/tags/RAM%E3%80%81%E5%AD%98%E5%82%A8/" style="font-size: 1.15em; color: rgb(57, 125, 156)">RAM、存储</a><a href="/tags/%E5%A4%9A%E6%A0%B8%E6%9E%B6%E6%9E%84/" style="font-size: 1.15em; color: rgb(158, 36, 123)">多核架构</a><a href="/tags/SSD/" style="font-size: 1.27em; color: rgb(70, 42, 146)">SSD</a><a href="/tags/PCIe/" style="font-size: 1.15em; color: rgb(123, 145, 68)">PCIe</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">九月 2022</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/07/"><span class="card-archive-list-date">七月 2022</span><span class="card-archive-list-count">35</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">五月 2022</span><span class="card-archive-list-count">6</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">55</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-10-22T10:19:48.707Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Smartog</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/pluginsSrc/medium-zoom/dist/medium-zoom.min.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="/pluginsSrc/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="/pluginsSrc/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>